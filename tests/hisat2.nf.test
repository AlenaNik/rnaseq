nextflow_pipeline {

    name "Test pipeline with HISAT2 aligner"
    script "../main.nf"

    test("Params: --aligner hisat2") {

        when {
            params {
                outdir = "$outputDir"
                aligner = 'hisat2'
            }
        }

        then {
            assertAll(
                { assert workflow.success },
                { assert snapshot(
                    // These files are not stable
                    file("${params.outdir}/bbsplit/RAP1_IAA_30M_REP1.stats.txt").name,
                    file("${params.outdir}/bbsplit/RAP1_UNINDUCED_REP1.stats.txt").name,
                    file("${params.outdir}/bbsplit/RAP1_UNINDUCED_REP2.stats.txt").name,
                    file("${params.outdir}/bbsplit/WT_REP1.stats.txt").name,
                    file("${params.outdir}/bbsplit/WT_REP2.stats.txt").name
                ).match("bbsplit") },
                { assert snapshot(
                    path("${params.outdir}/custom/out/genome_gfp.fasta"),
                    path("${params.outdir}/custom/out/genome_gfp.gtf")
                ).match("references") },
                { assert snapshot(
                    // HTMLs and ZIPs are not stable
                    file("${params.outdir}/fastqc/raw/RAP1_IAA_30M_REP1_raw_1_fastqc.html").name,
                    file("${params.outdir}/fastqc/raw/RAP1_IAA_30M_REP1_raw_1_fastqc.zip").name,
                    file("${params.outdir}/fastqc/raw/RAP1_IAA_30M_REP1_raw_2_fastqc.html").name,
                    file("${params.outdir}/fastqc/raw/RAP1_IAA_30M_REP1_raw_2_fastqc.zip").name,
                    file("${params.outdir}/fastqc/raw/RAP1_UNINDUCED_REP1_raw_fastqc.html").name,
                    file("${params.outdir}/fastqc/raw/RAP1_UNINDUCED_REP1_raw_fastqc.zip").name,
                    file("${params.outdir}/fastqc/raw/RAP1_UNINDUCED_REP2_raw_fastqc.html").name,
                    file("${params.outdir}/fastqc/raw/RAP1_UNINDUCED_REP2_raw_fastqc.zip").name,
                    file("${params.outdir}/fastqc/raw/WT_REP1_raw_1_fastqc.html").name,
                    file("${params.outdir}/fastqc/raw/WT_REP1_raw_1_fastqc.zip").name,
                    file("${params.outdir}/fastqc/raw/WT_REP1_raw_2_fastqc.html").name,
                    file("${params.outdir}/fastqc/raw/WT_REP1_raw_2_fastqc.zip").name,
                    file("${params.outdir}/fastqc/raw/WT_REP2_raw_1_fastqc.html").name,
                    file("${params.outdir}/fastqc/raw/WT_REP2_raw_1_fastqc.zip").name,
                    file("${params.outdir}/fastqc/raw/WT_REP2_raw_2_fastqc.html").name,
                    file("${params.outdir}/fastqc/raw/WT_REP2_raw_2_fastqc.zip").name
                ).match("fastqc/raw") },
                { assert snapshot(
                    // HTMLs and ZIPs are not stable
                    file("${params.outdir}/fastqc/trim/RAP1_IAA_30M_REP1_trimmed_1_val_1_fastqc.html").name,
                    file("${params.outdir}/fastqc/trim/RAP1_IAA_30M_REP1_trimmed_1_val_1_fastqc.zip").name,
                    file("${params.outdir}/fastqc/trim/RAP1_IAA_30M_REP1_trimmed_2_val_2_fastqc.html").name,
                    file("${params.outdir}/fastqc/trim/RAP1_IAA_30M_REP1_trimmed_2_val_2_fastqc.zip").name,
                    file("${params.outdir}/fastqc/trim/RAP1_UNINDUCED_REP1_trimmed_trimmed_fastqc.html").name,
                    file("${params.outdir}/fastqc/trim/RAP1_UNINDUCED_REP1_trimmed_trimmed_fastqc.zip").name,
                    file("${params.outdir}/fastqc/trim/RAP1_UNINDUCED_REP2_trimmed_trimmed_fastqc.html").name,
                    file("${params.outdir}/fastqc/trim/RAP1_UNINDUCED_REP2_trimmed_trimmed_fastqc.zip").name,
                    file("${params.outdir}/fastqc/trim/WT_REP1_trimmed_1_val_1_fastqc.html").name,
                    file("${params.outdir}/fastqc/trim/WT_REP1_trimmed_1_val_1_fastqc.zip").name,
                    file("${params.outdir}/fastqc/trim/WT_REP1_trimmed_2_val_2_fastqc.html").name,
                    file("${params.outdir}/fastqc/trim/WT_REP1_trimmed_2_val_2_fastqc.zip").name,
                    file("${params.outdir}/fastqc/trim/WT_REP2_trimmed_1_val_1_fastqc.html").name,
                    file("${params.outdir}/fastqc/trim/WT_REP2_trimmed_1_val_1_fastqc.zip").name,
                    file("${params.outdir}/fastqc/trim/WT_REP2_trimmed_2_val_2_fastqc.html").name,
                    file("${params.outdir}/fastqc/trim/WT_REP2_trimmed_2_val_2_fastqc.zip").name
                ).match("fastqc/trim") },
                { assert snapshot(
                    path("${params.outdir}/hisat2/bigwig/RAP1_IAA_30M_REP1.forward.bigWig"),
                    path("${params.outdir}/hisat2/bigwig/RAP1_IAA_30M_REP1.reverse.bigWig"),
                    path("${params.outdir}/hisat2/bigwig/RAP1_UNINDUCED_REP1.forward.bigWig"),
                    path("${params.outdir}/hisat2/bigwig/RAP1_UNINDUCED_REP1.reverse.bigWig"),
                    path("${params.outdir}/hisat2/bigwig/RAP1_UNINDUCED_REP2.forward.bigWig"),
                    path("${params.outdir}/hisat2/bigwig/RAP1_UNINDUCED_REP2.reverse.bigWig"),
                    path("${params.outdir}/hisat2/bigwig/WT_REP1.forward.bigWig"),
                    path("${params.outdir}/hisat2/bigwig/WT_REP1.reverse.bigWig"),
                    path("${params.outdir}/hisat2/bigwig/WT_REP2.forward.bigWig"),
                    path("${params.outdir}/hisat2/bigwig/WT_REP2.reverse.bigWig")
                ).match("hisat2/bigwig") },
                { assert snapshot(
                    path("${params.outdir}/hisat2/dupradar/gene_data/RAP1_IAA_30M_REP1_dupMatrix.txt"),
                    path("${params.outdir}/hisat2/dupradar/gene_data/RAP1_UNINDUCED_REP1_dupMatrix.txt"),
                    path("${params.outdir}/hisat2/dupradar/gene_data/RAP1_UNINDUCED_REP2_dupMatrix.txt"),
                    path("${params.outdir}/hisat2/dupradar/gene_data/WT_REP1_dupMatrix.txt"),
                    path("${params.outdir}/hisat2/dupradar/gene_data/WT_REP2_dupMatrix.txt"),
                    path("${params.outdir}/hisat2/dupradar/intercepts_slope/RAP1_IAA_30M_REP1_intercept_slope.txt"),
                    path("${params.outdir}/hisat2/dupradar/intercepts_slope/RAP1_UNINDUCED_REP1_intercept_slope.txt"),
                    path("${params.outdir}/hisat2/dupradar/intercepts_slope/RAP1_UNINDUCED_REP2_intercept_slope.txt"),
                    path("${params.outdir}/hisat2/dupradar/intercepts_slope/WT_REP1_intercept_slope.txt"),
                    path("${params.outdir}/hisat2/dupradar/intercepts_slope/WT_REP2_intercept_slope.txt"),
                    // PDFs are not stable
                    file("${params.outdir}/hisat2/dupradar/box_plot/RAP1_IAA_30M_REP1_duprateExpBoxplot.pdf").name,
                    file("${params.outdir}/hisat2/dupradar/box_plot/RAP1_UNINDUCED_REP1_duprateExpBoxplot.pdf").name,
                    file("${params.outdir}/hisat2/dupradar/box_plot/RAP1_UNINDUCED_REP2_duprateExpBoxplot.pdf").name,
                    file("${params.outdir}/hisat2/dupradar/box_plot/WT_REP1_duprateExpBoxplot.pdf").name,
                    file("${params.outdir}/hisat2/dupradar/box_plot/WT_REP2_duprateExpBoxplot.pdf").name,
                    file("${params.outdir}/hisat2/dupradar/histogram/RAP1_IAA_30M_REP1_expressionHist.pdf").name,
                    file("${params.outdir}/hisat2/dupradar/histogram/RAP1_UNINDUCED_REP1_expressionHist.pdf").name,
                    file("${params.outdir}/hisat2/dupradar/histogram/RAP1_UNINDUCED_REP2_expressionHist.pdf").name,
                    file("${params.outdir}/hisat2/dupradar/histogram/WT_REP1_expressionHist.pdf").name,
                    file("${params.outdir}/hisat2/dupradar/histogram/WT_REP2_expressionHist.pdf").name,
                    file("${params.outdir}/hisat2/dupradar/scatter_plot/RAP1_IAA_30M_REP1_duprateExpDens.pdf").name,
                    file("${params.outdir}/hisat2/dupradar/scatter_plot/RAP1_UNINDUCED_REP1_duprateExpDens.pdf").name,
                    file("${params.outdir}/hisat2/dupradar/scatter_plot/RAP1_UNINDUCED_REP2_duprateExpDens.pdf").name,
                    file("${params.outdir}/hisat2/dupradar/scatter_plot/WT_REP1_duprateExpDens.pdf").name,
                    file("${params.outdir}/hisat2/dupradar/scatter_plot/WT_REP2_duprateExpDens.pdf").name
                ).match("hisat2/dupradar") },
                { assert snapshot(
                    path("${params.outdir}/hisat2/featurecounts/RAP1_IAA_30M_REP1.biotype_counts_mqc.tsv"),
                    path("${params.outdir}/hisat2/featurecounts/RAP1_IAA_30M_REP1.biotype_counts_rrna_mqc.tsv"),
                    path("${params.outdir}/hisat2/featurecounts/RAP1_IAA_30M_REP1.featureCounts.txt"),
                    path("${params.outdir}/hisat2/featurecounts/RAP1_IAA_30M_REP1.featureCounts.txt.summary"),
                    path("${params.outdir}/hisat2/featurecounts/RAP1_UNINDUCED_REP1.biotype_counts_mqc.tsv"),
                    path("${params.outdir}/hisat2/featurecounts/RAP1_UNINDUCED_REP1.biotype_counts_rrna_mqc.tsv"),
                    path("${params.outdir}/hisat2/featurecounts/RAP1_UNINDUCED_REP1.featureCounts.txt"),
                    path("${params.outdir}/hisat2/featurecounts/RAP1_UNINDUCED_REP1.featureCounts.txt.summary"),
                    path("${params.outdir}/hisat2/featurecounts/RAP1_UNINDUCED_REP2.biotype_counts_mqc.tsv"),
                    path("${params.outdir}/hisat2/featurecounts/RAP1_UNINDUCED_REP2.biotype_counts_rrna_mqc.tsv"),
                    path("${params.outdir}/hisat2/featurecounts/RAP1_UNINDUCED_REP2.featureCounts.txt"),
                    path("${params.outdir}/hisat2/featurecounts/RAP1_UNINDUCED_REP2.featureCounts.txt.summary"),
                    path("${params.outdir}/hisat2/featurecounts/WT_REP1.biotype_counts_mqc.tsv"),
                    path("${params.outdir}/hisat2/featurecounts/WT_REP1.biotype_counts_rrna_mqc.tsv"),
                    path("${params.outdir}/hisat2/featurecounts/WT_REP1.featureCounts.txt"),
                    path("${params.outdir}/hisat2/featurecounts/WT_REP1.featureCounts.txt.summary"),
                    path("${params.outdir}/hisat2/featurecounts/WT_REP2.biotype_counts_mqc.tsv"),
                    path("${params.outdir}/hisat2/featurecounts/WT_REP2.biotype_counts_rrna_mqc.tsv"),
                    path("${params.outdir}/hisat2/featurecounts/WT_REP2.featureCounts.txt"),
                    path("${params.outdir}/hisat2/featurecounts/WT_REP2.featureCounts.txt.summary")
                ).match("hisat2/featurecounts") },
                { assert snapshot(
                    path("${params.outdir}/hisat2/log/RAP1_IAA_30M_REP1.hisat2.summary.log"),
                    path("${params.outdir}/hisat2/log/RAP1_UNINDUCED_REP1.hisat2.summary.log"),
                    path("${params.outdir}/hisat2/log/RAP1_UNINDUCED_REP2.hisat2.summary.log"),
                    path("${params.outdir}/hisat2/log/WT_REP1.hisat2.summary.log"),
                    path("${params.outdir}/hisat2/log/WT_REP2.hisat2.summary.log"),
                    // These files are not stable
                    file("${params.outdir}/hisat2/RAP1_IAA_30M_REP1.markdup.sorted.bam").name,
                    file("${params.outdir}/hisat2/RAP1_IAA_30M_REP1.markdup.sorted.bam.bai").name,
                    file("${params.outdir}/hisat2/RAP1_UNINDUCED_REP1.markdup.sorted.bam").name,
                    file("${params.outdir}/hisat2/RAP1_UNINDUCED_REP1.markdup.sorted.bam.bai").name,
                    file("${params.outdir}/hisat2/RAP1_UNINDUCED_REP2.markdup.sorted.bam").name,
                    file("${params.outdir}/hisat2/RAP1_UNINDUCED_REP2.markdup.sorted.bam.bai").name,
                    file("${params.outdir}/hisat2/WT_REP1.markdup.sorted.bam").name,
                    file("${params.outdir}/hisat2/WT_REP1.markdup.sorted.bam.bai").name,
                    file("${params.outdir}/hisat2/WT_REP2.markdup.sorted.bam").name,
                    file("${params.outdir}/hisat2/WT_REP2.markdup.sorted.bam.bai").name
                ).match("hisat2") },
                { assert snapshot(
                    // Metrics are not stable
                    file("${params.outdir}/hisat2/picard_metrics/RAP1_IAA_30M_REP1.markdup.sorted.MarkDuplicates.metrics.txt").name,
                    file("${params.outdir}/hisat2/picard_metrics/RAP1_UNINDUCED_REP1.markdup.sorted.MarkDuplicates.metrics.txt").name,
                    file("${params.outdir}/hisat2/picard_metrics/RAP1_UNINDUCED_REP2.markdup.sorted.MarkDuplicates.metrics.txt").name,
                    file("${params.outdir}/hisat2/picard_metrics/WT_REP1.markdup.sorted.MarkDuplicates.metrics.txt").name,
                    file("${params.outdir}/hisat2/picard_metrics/WT_REP2.markdup.sorted.MarkDuplicates.metrics.txt").name
                ).match("hisat2/picard_metrics") },
                { assert snapshot(
                    path("${params.outdir}/hisat2/qualimap/RAP1_IAA_30M_REP1/images_qualimapReport/Coverage Profile Along Genes (High).png"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_IAA_30M_REP1/images_qualimapReport/Coverage Profile Along Genes (Low).png"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_IAA_30M_REP1/images_qualimapReport/Coverage Profile Along Genes (Total).png"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_IAA_30M_REP1/images_qualimapReport/Junction Analysis.png"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_IAA_30M_REP1/images_qualimapReport/Reads Genomic Origin.png"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_IAA_30M_REP1/images_qualimapReport/Transcript coverage histogram.png"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_IAA_30M_REP1/raw_data_qualimapReport/coverage_profile_along_genes_(high).txt"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_IAA_30M_REP1/raw_data_qualimapReport/coverage_profile_along_genes_(low).txt"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_IAA_30M_REP1/raw_data_qualimapReport/coverage_profile_along_genes_(total).txt"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_IAA_30M_REP1/rnaseq_qc_results.txt"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_UNINDUCED_REP1/images_qualimapReport/Coverage Profile Along Genes (High).png"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_UNINDUCED_REP1/images_qualimapReport/Coverage Profile Along Genes (Low).png"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_UNINDUCED_REP1/images_qualimapReport/Coverage Profile Along Genes (Total).png"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_UNINDUCED_REP1/images_qualimapReport/Junction Analysis.png"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_UNINDUCED_REP1/images_qualimapReport/Reads Genomic Origin.png"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_UNINDUCED_REP1/images_qualimapReport/Transcript coverage histogram.png"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_UNINDUCED_REP1/raw_data_qualimapReport/coverage_profile_along_genes_(high).txt"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_UNINDUCED_REP1/raw_data_qualimapReport/coverage_profile_along_genes_(low).txt"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_UNINDUCED_REP1/raw_data_qualimapReport/coverage_profile_along_genes_(total).txt"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_UNINDUCED_REP1/rnaseq_qc_results.txt"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_UNINDUCED_REP2/images_qualimapReport/Coverage Profile Along Genes (High).png"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_UNINDUCED_REP2/images_qualimapReport/Coverage Profile Along Genes (Low).png"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_UNINDUCED_REP2/images_qualimapReport/Coverage Profile Along Genes (Total).png"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_UNINDUCED_REP2/images_qualimapReport/Junction Analysis.png"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_UNINDUCED_REP2/images_qualimapReport/Reads Genomic Origin.png"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_UNINDUCED_REP2/images_qualimapReport/Transcript coverage histogram.png"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_UNINDUCED_REP2/raw_data_qualimapReport/coverage_profile_along_genes_(high).txt"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_UNINDUCED_REP2/raw_data_qualimapReport/coverage_profile_along_genes_(low).txt"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_UNINDUCED_REP2/raw_data_qualimapReport/coverage_profile_along_genes_(total).txt"),
                    path("${params.outdir}/hisat2/qualimap/RAP1_UNINDUCED_REP2/rnaseq_qc_results.txt"),
                    path("${params.outdir}/hisat2/qualimap/WT_REP1/images_qualimapReport/Coverage Profile Along Genes (High).png"),
                    path("${params.outdir}/hisat2/qualimap/WT_REP1/images_qualimapReport/Coverage Profile Along Genes (Low).png"),
                    path("${params.outdir}/hisat2/qualimap/WT_REP1/images_qualimapReport/Coverage Profile Along Genes (Total).png"),
                    path("${params.outdir}/hisat2/qualimap/WT_REP1/images_qualimapReport/Junction Analysis.png"),
                    path("${params.outdir}/hisat2/qualimap/WT_REP1/images_qualimapReport/Reads Genomic Origin.png"),
                    path("${params.outdir}/hisat2/qualimap/WT_REP1/images_qualimapReport/Transcript coverage histogram.png"),
                    path("${params.outdir}/hisat2/qualimap/WT_REP1/raw_data_qualimapReport/coverage_profile_along_genes_(high).txt"),
                    path("${params.outdir}/hisat2/qualimap/WT_REP1/raw_data_qualimapReport/coverage_profile_along_genes_(low).txt"),
                    path("${params.outdir}/hisat2/qualimap/WT_REP1/raw_data_qualimapReport/coverage_profile_along_genes_(total).txt"),
                    path("${params.outdir}/hisat2/qualimap/WT_REP1/rnaseq_qc_results.txt"),
                    path("${params.outdir}/hisat2/qualimap/WT_REP2/images_qualimapReport/Coverage Profile Along Genes (High).png"),
                    path("${params.outdir}/hisat2/qualimap/WT_REP2/images_qualimapReport/Coverage Profile Along Genes (Low).png"),
                    path("${params.outdir}/hisat2/qualimap/WT_REP2/images_qualimapReport/Coverage Profile Along Genes (Total).png"),
                    path("${params.outdir}/hisat2/qualimap/WT_REP2/images_qualimapReport/Junction Analysis.png"),
                    path("${params.outdir}/hisat2/qualimap/WT_REP2/images_qualimapReport/Reads Genomic Origin.png"),
                    path("${params.outdir}/hisat2/qualimap/WT_REP2/images_qualimapReport/Transcript coverage histogram.png"),
                    path("${params.outdir}/hisat2/qualimap/WT_REP2/raw_data_qualimapReport/coverage_profile_along_genes_(high).txt"),
                    path("${params.outdir}/hisat2/qualimap/WT_REP2/raw_data_qualimapReport/coverage_profile_along_genes_(low).txt"),
                    path("${params.outdir}/hisat2/qualimap/WT_REP2/raw_data_qualimapReport/coverage_profile_along_genes_(total).txt"),
                    path("${params.outdir}/hisat2/qualimap/WT_REP2/rnaseq_qc_results.txt"),
                    // HTML reports are not stable
                    file("${params.outdir}/hisat2/qualimap/RAP1_IAA_30M_REP1/qualimapReport.html").name,
                    file("${params.outdir}/hisat2/qualimap/RAP1_UNINDUCED_REP1/qualimapReport.html").name,
                    file("${params.outdir}/hisat2/qualimap/RAP1_UNINDUCED_REP2/qualimapReport.html").name,
                    file("${params.outdir}/hisat2/qualimap/WT_REP1/qualimapReport.html").name,
                    file("${params.outdir}/hisat2/qualimap/WT_REP2/qualimapReport.html").name
                ).match("hisat2/qualimap") },
                { assert snapshot(
                    path("${params.outdir}/hisat2/rseqc/bam_stat/RAP1_IAA_30M_REP1.bam_stat.txt"),
                    path("${params.outdir}/hisat2/rseqc/bam_stat/RAP1_UNINDUCED_REP1.bam_stat.txt"),
                    path("${params.outdir}/hisat2/rseqc/bam_stat/RAP1_UNINDUCED_REP2.bam_stat.txt"),
                    path("${params.outdir}/hisat2/rseqc/bam_stat/WT_REP1.bam_stat.txt"),
                    path("${params.outdir}/hisat2/rseqc/bam_stat/WT_REP2.bam_stat.txt"),
                    path("${params.outdir}/hisat2/rseqc/infer_experiment/RAP1_IAA_30M_REP1.infer_experiment.txt"),
                    path("${params.outdir}/hisat2/rseqc/infer_experiment/RAP1_UNINDUCED_REP1.infer_experiment.txt"),
                    path("${params.outdir}/hisat2/rseqc/infer_experiment/RAP1_UNINDUCED_REP2.infer_experiment.txt"),
                    path("${params.outdir}/hisat2/rseqc/infer_experiment/WT_REP1.infer_experiment.txt"),
                    path("${params.outdir}/hisat2/rseqc/infer_experiment/WT_REP2.infer_experiment.txt"),
                    path("${params.outdir}/hisat2/rseqc/junction_annotation/bed/RAP1_IAA_30M_REP1.junction.Interact.bed"),
                    path("${params.outdir}/hisat2/rseqc/junction_annotation/bed/RAP1_IAA_30M_REP1.junction.bed"),
                    path("${params.outdir}/hisat2/rseqc/junction_annotation/bed/RAP1_UNINDUCED_REP1.junction.Interact.bed"),
                    path("${params.outdir}/hisat2/rseqc/junction_annotation/bed/RAP1_UNINDUCED_REP1.junction.bed"),
                    path("${params.outdir}/hisat2/rseqc/junction_annotation/bed/RAP1_UNINDUCED_REP2.junction.Interact.bed"),
                    path("${params.outdir}/hisat2/rseqc/junction_annotation/bed/RAP1_UNINDUCED_REP2.junction.bed"),
                    path("${params.outdir}/hisat2/rseqc/junction_annotation/bed/WT_REP1.junction.Interact.bed"),
                    path("${params.outdir}/hisat2/rseqc/junction_annotation/bed/WT_REP1.junction.bed"),
                    path("${params.outdir}/hisat2/rseqc/junction_annotation/bed/WT_REP2.junction.Interact.bed"),
                    path("${params.outdir}/hisat2/rseqc/junction_annotation/bed/WT_REP2.junction.bed"),
                    path("${params.outdir}/hisat2/rseqc/junction_annotation/log/RAP1_IAA_30M_REP1.junction_annotation.log"),
                    path("${params.outdir}/hisat2/rseqc/junction_annotation/log/RAP1_UNINDUCED_REP1.junction_annotation.log"),
                    path("${params.outdir}/hisat2/rseqc/junction_annotation/log/RAP1_UNINDUCED_REP2.junction_annotation.log"),
                    path("${params.outdir}/hisat2/rseqc/junction_annotation/log/WT_REP1.junction_annotation.log"),
                    path("${params.outdir}/hisat2/rseqc/junction_annotation/log/WT_REP2.junction_annotation.log"),
                    path("${params.outdir}/hisat2/rseqc/junction_annotation/rscript/RAP1_IAA_30M_REP1.junction_plot.r"),
                    path("${params.outdir}/hisat2/rseqc/junction_annotation/rscript/RAP1_UNINDUCED_REP1.junction_plot.r"),
                    path("${params.outdir}/hisat2/rseqc/junction_annotation/rscript/RAP1_UNINDUCED_REP2.junction_plot.r"),
                    path("${params.outdir}/hisat2/rseqc/junction_annotation/rscript/WT_REP1.junction_plot.r"),
                    path("${params.outdir}/hisat2/rseqc/junction_annotation/rscript/WT_REP2.junction_plot.r"),
                    path("${params.outdir}/hisat2/rseqc/junction_annotation/xls/RAP1_IAA_30M_REP1.junction.xls"),
                    path("${params.outdir}/hisat2/rseqc/junction_annotation/xls/RAP1_UNINDUCED_REP1.junction.xls"),
                    path("${params.outdir}/hisat2/rseqc/junction_annotation/xls/RAP1_UNINDUCED_REP2.junction.xls"),
                    path("${params.outdir}/hisat2/rseqc/junction_annotation/xls/WT_REP1.junction.xls"),
                    path("${params.outdir}/hisat2/rseqc/junction_annotation/xls/WT_REP2.junction.xls"),
                    path("${params.outdir}/hisat2/rseqc/read_distribution/RAP1_IAA_30M_REP1.read_distribution.txt"),
                    path("${params.outdir}/hisat2/rseqc/read_distribution/RAP1_UNINDUCED_REP1.read_distribution.txt"),
                    path("${params.outdir}/hisat2/rseqc/read_distribution/RAP1_UNINDUCED_REP2.read_distribution.txt"),
                    path("${params.outdir}/hisat2/rseqc/read_distribution/WT_REP1.read_distribution.txt"),
                    path("${params.outdir}/hisat2/rseqc/read_distribution/WT_REP2.read_distribution.txt"),
                    path("${params.outdir}/hisat2/rseqc/read_duplication/rscript/RAP1_IAA_30M_REP1.DupRate_plot.r"),
                    path("${params.outdir}/hisat2/rseqc/read_duplication/rscript/RAP1_UNINDUCED_REP1.DupRate_plot.r"),
                    path("${params.outdir}/hisat2/rseqc/read_duplication/rscript/RAP1_UNINDUCED_REP2.DupRate_plot.r"),
                    path("${params.outdir}/hisat2/rseqc/read_duplication/rscript/WT_REP1.DupRate_plot.r"),
                    path("${params.outdir}/hisat2/rseqc/read_duplication/rscript/WT_REP2.DupRate_plot.r"),
                    path("${params.outdir}/hisat2/rseqc/read_duplication/xls/RAP1_IAA_30M_REP1.pos.DupRate.xls"),
                    path("${params.outdir}/hisat2/rseqc/read_duplication/xls/RAP1_IAA_30M_REP1.seq.DupRate.xls"),
                    path("${params.outdir}/hisat2/rseqc/read_duplication/xls/RAP1_UNINDUCED_REP1.pos.DupRate.xls"),
                    path("${params.outdir}/hisat2/rseqc/read_duplication/xls/RAP1_UNINDUCED_REP1.seq.DupRate.xls"),
                    path("${params.outdir}/hisat2/rseqc/read_duplication/xls/RAP1_UNINDUCED_REP2.pos.DupRate.xls"),
                    path("${params.outdir}/hisat2/rseqc/read_duplication/xls/RAP1_UNINDUCED_REP2.seq.DupRate.xls"),
                    path("${params.outdir}/hisat2/rseqc/read_duplication/xls/WT_REP1.pos.DupRate.xls"),
                    path("${params.outdir}/hisat2/rseqc/read_duplication/xls/WT_REP1.seq.DupRate.xls"),
                    path("${params.outdir}/hisat2/rseqc/read_duplication/xls/WT_REP2.pos.DupRate.xls"),
                    path("${params.outdir}/hisat2/rseqc/read_duplication/xls/WT_REP2.seq.DupRate.xls"),
                    // PDFs and R scripts are not stable
                    file("${params.outdir}/hisat2/rseqc/inner_distance/pdf/RAP1_IAA_30M_REP1.inner_distance_plot.pdf").name,
                    file("${params.outdir}/hisat2/rseqc/inner_distance/pdf/WT_REP1.inner_distance_plot.pdf").name,
                    file("${params.outdir}/hisat2/rseqc/inner_distance/pdf/WT_REP2.inner_distance_plot.pdf").name,
                    file("${params.outdir}/hisat2/rseqc/inner_distance/rscript/RAP1_IAA_30M_REP1.inner_distance_plot.r").name,
                    file("${params.outdir}/hisat2/rseqc/inner_distance/rscript/WT_REP1.inner_distance_plot.r").name,
                    file("${params.outdir}/hisat2/rseqc/inner_distance/rscript/WT_REP2.inner_distance_plot.r").name,
                    file("${params.outdir}/hisat2/rseqc/inner_distance/txt/RAP1_IAA_30M_REP1.inner_distance.txt").name,
                    file("${params.outdir}/hisat2/rseqc/inner_distance/txt/RAP1_IAA_30M_REP1.inner_distance_freq.txt").name,
                    file("${params.outdir}/hisat2/rseqc/inner_distance/txt/RAP1_IAA_30M_REP1.inner_distance_mean.txt").name,
                    file("${params.outdir}/hisat2/rseqc/inner_distance/txt/WT_REP1.inner_distance.txt").name,
                    file("${params.outdir}/hisat2/rseqc/inner_distance/txt/WT_REP1.inner_distance_freq.txt").name,
                    file("${params.outdir}/hisat2/rseqc/inner_distance/txt/WT_REP1.inner_distance_mean.txt").name,
                    file("${params.outdir}/hisat2/rseqc/inner_distance/txt/WT_REP2.inner_distance.txt").name,
                    file("${params.outdir}/hisat2/rseqc/inner_distance/txt/WT_REP2.inner_distance_freq.txt").name,
                    file("${params.outdir}/hisat2/rseqc/inner_distance/txt/WT_REP2.inner_distance_mean.txt").name,
                    file("${params.outdir}/hisat2/rseqc/junction_annotation/pdf/RAP1_IAA_30M_REP1.splice_events.pdf").name,
                    file("${params.outdir}/hisat2/rseqc/junction_annotation/pdf/RAP1_IAA_30M_REP1.splice_junction.pdf").name,
                    file("${params.outdir}/hisat2/rseqc/junction_annotation/pdf/RAP1_UNINDUCED_REP1.splice_events.pdf").name,
                    file("${params.outdir}/hisat2/rseqc/junction_annotation/pdf/RAP1_UNINDUCED_REP1.splice_junction.pdf").name,
                    file("${params.outdir}/hisat2/rseqc/junction_annotation/pdf/RAP1_UNINDUCED_REP2.splice_events.pdf").name,
                    file("${params.outdir}/hisat2/rseqc/junction_annotation/pdf/RAP1_UNINDUCED_REP2.splice_junction.pdf").name,
                    file("${params.outdir}/hisat2/rseqc/junction_annotation/pdf/WT_REP1.splice_events.pdf").name,
                    file("${params.outdir}/hisat2/rseqc/junction_annotation/pdf/WT_REP1.splice_junction.pdf").name,
                    file("${params.outdir}/hisat2/rseqc/junction_annotation/pdf/WT_REP2.splice_events.pdf").name,
                    file("${params.outdir}/hisat2/rseqc/junction_annotation/pdf/WT_REP2.splice_junction.pdf").name,
                    file("${params.outdir}/hisat2/rseqc/junction_saturation/pdf/RAP1_IAA_30M_REP1.junctionSaturation_plot.pdf").name,
                    file("${params.outdir}/hisat2/rseqc/junction_saturation/pdf/RAP1_UNINDUCED_REP1.junctionSaturation_plot.pdf").name,
                    file("${params.outdir}/hisat2/rseqc/junction_saturation/pdf/RAP1_UNINDUCED_REP2.junctionSaturation_plot.pdf").name,
                    file("${params.outdir}/hisat2/rseqc/junction_saturation/pdf/WT_REP1.junctionSaturation_plot.pdf").name,
                    file("${params.outdir}/hisat2/rseqc/junction_saturation/pdf/WT_REP2.junctionSaturation_plot.pdf").name,
                    file("${params.outdir}/hisat2/rseqc/junction_saturation/rscript/RAP1_IAA_30M_REP1.junctionSaturation_plot.r").name,
                    file("${params.outdir}/hisat2/rseqc/junction_saturation/rscript/RAP1_UNINDUCED_REP1.junctionSaturation_plot.r").name,
                    file("${params.outdir}/hisat2/rseqc/junction_saturation/rscript/RAP1_UNINDUCED_REP2.junctionSaturation_plot.r").name,
                    file("${params.outdir}/hisat2/rseqc/junction_saturation/rscript/WT_REP1.junctionSaturation_plot.r").name,
                    file("${params.outdir}/hisat2/rseqc/junction_saturation/rscript/WT_REP2.junctionSaturation_plot.r").name,
                    file("${params.outdir}/hisat2/rseqc/read_duplication/pdf/RAP1_IAA_30M_REP1.DupRate_plot.pdf").name,
                    file("${params.outdir}/hisat2/rseqc/read_duplication/pdf/RAP1_UNINDUCED_REP1.DupRate_plot.pdf").name,
                    file("${params.outdir}/hisat2/rseqc/read_duplication/pdf/RAP1_UNINDUCED_REP2.DupRate_plot.pdf").name,
                    file("${params.outdir}/hisat2/rseqc/read_duplication/pdf/WT_REP1.DupRate_plot.pdf").name,
                    file("${params.outdir}/hisat2/rseqc/read_duplication/pdf/WT_REP2.DupRate_plot.pdf").name
                ).match("hisat2/rseqc") },
                { assert snapshot(
                    path("${params.outdir}/hisat2/samtools_stats/RAP1_IAA_30M_REP1.markdup.sorted.bam.flagstat"),
                    path("${params.outdir}/hisat2/samtools_stats/RAP1_IAA_30M_REP1.markdup.sorted.bam.idxstats"),
                    path("${params.outdir}/hisat2/samtools_stats/RAP1_IAA_30M_REP1.markdup.sorted.bam.stats"),
                    path("${params.outdir}/hisat2/samtools_stats/RAP1_IAA_30M_REP1.sorted.bam.flagstat"),
                    path("${params.outdir}/hisat2/samtools_stats/RAP1_IAA_30M_REP1.sorted.bam.idxstats"),
                    path("${params.outdir}/hisat2/samtools_stats/RAP1_IAA_30M_REP1.sorted.bam.stats"),
                    path("${params.outdir}/hisat2/samtools_stats/RAP1_UNINDUCED_REP1.markdup.sorted.bam.flagstat"),
                    path("${params.outdir}/hisat2/samtools_stats/RAP1_UNINDUCED_REP1.markdup.sorted.bam.idxstats"),
                    path("${params.outdir}/hisat2/samtools_stats/RAP1_UNINDUCED_REP1.markdup.sorted.bam.stats"),
                    path("${params.outdir}/hisat2/samtools_stats/RAP1_UNINDUCED_REP1.sorted.bam.flagstat"),
                    path("${params.outdir}/hisat2/samtools_stats/RAP1_UNINDUCED_REP1.sorted.bam.idxstats"),
                    path("${params.outdir}/hisat2/samtools_stats/RAP1_UNINDUCED_REP1.sorted.bam.stats"),
                    path("${params.outdir}/hisat2/samtools_stats/RAP1_UNINDUCED_REP2.markdup.sorted.bam.flagstat"),
                    path("${params.outdir}/hisat2/samtools_stats/RAP1_UNINDUCED_REP2.markdup.sorted.bam.idxstats"),
                    path("${params.outdir}/hisat2/samtools_stats/RAP1_UNINDUCED_REP2.markdup.sorted.bam.stats"),
                    path("${params.outdir}/hisat2/samtools_stats/RAP1_UNINDUCED_REP2.sorted.bam.flagstat"),
                    path("${params.outdir}/hisat2/samtools_stats/RAP1_UNINDUCED_REP2.sorted.bam.idxstats"),
                    path("${params.outdir}/hisat2/samtools_stats/RAP1_UNINDUCED_REP2.sorted.bam.stats"),
                    path("${params.outdir}/hisat2/samtools_stats/WT_REP1.markdup.sorted.bam.flagstat"),
                    path("${params.outdir}/hisat2/samtools_stats/WT_REP1.markdup.sorted.bam.idxstats"),
                    path("${params.outdir}/hisat2/samtools_stats/WT_REP1.markdup.sorted.bam.stats"),
                    path("${params.outdir}/hisat2/samtools_stats/WT_REP1.sorted.bam.flagstat"),
                    path("${params.outdir}/hisat2/samtools_stats/WT_REP1.sorted.bam.idxstats"),
                    path("${params.outdir}/hisat2/samtools_stats/WT_REP1.sorted.bam.stats"),
                    path("${params.outdir}/hisat2/samtools_stats/WT_REP2.markdup.sorted.bam.flagstat"),
                    path("${params.outdir}/hisat2/samtools_stats/WT_REP2.markdup.sorted.bam.idxstats"),
                    path("${params.outdir}/hisat2/samtools_stats/WT_REP2.markdup.sorted.bam.stats"),
                    path("${params.outdir}/hisat2/samtools_stats/WT_REP2.sorted.bam.flagstat"),
                    path("${params.outdir}/hisat2/samtools_stats/WT_REP2.sorted.bam.idxstats"),
                    path("${params.outdir}/hisat2/samtools_stats/WT_REP2.sorted.bam.stats")
                ).match("hisat2/samtools_stats") },
                { assert snapshot(
                    path("${params.outdir}/hisat2/stringtie/RAP1_IAA_30M_REP1.ballgown/e2t.ctab"),
                    path("${params.outdir}/hisat2/stringtie/RAP1_IAA_30M_REP1.ballgown/e_data.ctab"),
                    path("${params.outdir}/hisat2/stringtie/RAP1_IAA_30M_REP1.ballgown/i2t.ctab"),
                    path("${params.outdir}/hisat2/stringtie/RAP1_IAA_30M_REP1.ballgown/i_data.ctab"),
                    path("${params.outdir}/hisat2/stringtie/RAP1_UNINDUCED_REP1.ballgown/e2t.ctab"),
                    path("${params.outdir}/hisat2/stringtie/RAP1_UNINDUCED_REP1.ballgown/e_data.ctab"),
                    path("${params.outdir}/hisat2/stringtie/RAP1_UNINDUCED_REP1.ballgown/i2t.ctab"),
                    path("${params.outdir}/hisat2/stringtie/RAP1_UNINDUCED_REP1.ballgown/i_data.ctab"),
                    path("${params.outdir}/hisat2/stringtie/RAP1_UNINDUCED_REP2.ballgown/e2t.ctab"),
                    path("${params.outdir}/hisat2/stringtie/RAP1_UNINDUCED_REP2.ballgown/e_data.ctab"),
                    path("${params.outdir}/hisat2/stringtie/RAP1_UNINDUCED_REP2.ballgown/i2t.ctab"),
                    path("${params.outdir}/hisat2/stringtie/RAP1_UNINDUCED_REP2.ballgown/i_data.ctab"),
                    path("${params.outdir}/hisat2/stringtie/WT_REP1.ballgown/e2t.ctab"),
                    path("${params.outdir}/hisat2/stringtie/WT_REP1.ballgown/e_data.ctab"),
                    path("${params.outdir}/hisat2/stringtie/WT_REP1.ballgown/i2t.ctab"),
                    path("${params.outdir}/hisat2/stringtie/WT_REP1.ballgown/i_data.ctab"),
                    path("${params.outdir}/hisat2/stringtie/WT_REP2.ballgown/e2t.ctab"),
                    path("${params.outdir}/hisat2/stringtie/WT_REP2.ballgown/e_data.ctab"),
                    path("${params.outdir}/hisat2/stringtie/WT_REP2.ballgown/i2t.ctab"),
                    path("${params.outdir}/hisat2/stringtie/WT_REP2.ballgown/i_data.ctab"),
                    // These files are not stable
                    file("${params.outdir}/hisat2/stringtie/RAP1_IAA_30M_REP1.ballgown/t_data.ctab").name,
                    file("${params.outdir}/hisat2/stringtie/RAP1_IAA_30M_REP1.coverage.gtf").name,
                    file("${params.outdir}/hisat2/stringtie/RAP1_IAA_30M_REP1.gene.abundance.txt").name,
                    file("${params.outdir}/hisat2/stringtie/RAP1_IAA_30M_REP1.transcripts.gtf").name,
                    file("${params.outdir}/hisat2/stringtie/RAP1_UNINDUCED_REP1.ballgown/t_data.ctab").name,
                    file("${params.outdir}/hisat2/stringtie/RAP1_UNINDUCED_REP1.coverage.gtf").name,
                    file("${params.outdir}/hisat2/stringtie/RAP1_UNINDUCED_REP1.gene.abundance.txt").name,
                    file("${params.outdir}/hisat2/stringtie/RAP1_UNINDUCED_REP1.transcripts.gtf").name,
                    file("${params.outdir}/hisat2/stringtie/RAP1_UNINDUCED_REP2.ballgown/t_data.ctab").name,
                    file("${params.outdir}/hisat2/stringtie/RAP1_UNINDUCED_REP2.coverage.gtf").name,
                    file("${params.outdir}/hisat2/stringtie/RAP1_UNINDUCED_REP2.gene.abundance.txt").name,
                    file("${params.outdir}/hisat2/stringtie/RAP1_UNINDUCED_REP2.transcripts.gtf").name,
                    file("${params.outdir}/hisat2/stringtie/WT_REP1.ballgown/t_data.ctab").name,
                    file("${params.outdir}/hisat2/stringtie/WT_REP1.coverage.gtf").name,
                    file("${params.outdir}/hisat2/stringtie/WT_REP1.gene.abundance.txt").name,
                    file("${params.outdir}/hisat2/stringtie/WT_REP1.transcripts.gtf").name,
                    file("${params.outdir}/hisat2/stringtie/WT_REP2.ballgown/t_data.ctab").name,
                    file("${params.outdir}/hisat2/stringtie/WT_REP2.coverage.gtf").name,
                    file("${params.outdir}/hisat2/stringtie/WT_REP2.gene.abundance.txt").name,
                    file("${params.outdir}/hisat2/stringtie/WT_REP2.transcripts.gtf").name
                ).match("hisat2/stringtie") },
                { assert snapshot(
                    path("${params.outdir}/salmon/deseq2_qc/R_sessionInfo.log"),
                    // These files are not stable
                    file("${params.outdir}/salmon/deseq2_qc/deseq2.dds.RData").name,
                    file("${params.outdir}/salmon/deseq2_qc/deseq2.pca.vals.txt").name,
                    file("${params.outdir}/salmon/deseq2_qc/deseq2.plots.pdf").name,
                    file("${params.outdir}/salmon/deseq2_qc/deseq2.sample.dists.txt").name,
                    file("${params.outdir}/salmon/deseq2_qc/size_factors/RAP1_IAA_30M_REP1.txt").name,
                    file("${params.outdir}/salmon/deseq2_qc/size_factors/RAP1_UNINDUCED_REP1.txt").name,
                    file("${params.outdir}/salmon/deseq2_qc/size_factors/RAP1_UNINDUCED_REP2.txt").name,
                    file("${params.outdir}/salmon/deseq2_qc/size_factors/WT_REP1.txt").name,
                    file("${params.outdir}/salmon/deseq2_qc/size_factors/WT_REP2.txt").name,
                    file("${params.outdir}/salmon/deseq2_qc/size_factors/deseq2.size_factors.RData").name
                ).match("salmon/deseq2_qc") },
                { assert snapshot(
                    path("${params.outdir}/salmon/RAP1_IAA_30M_REP1/aux_info/ambig_info.tsv"),
                    path("${params.outdir}/salmon/RAP1_IAA_30M_REP1/aux_info/expected_bias.gz"),
                    path("${params.outdir}/salmon/RAP1_IAA_30M_REP1/aux_info/observed_bias.gz"),
                    path("${params.outdir}/salmon/RAP1_IAA_30M_REP1/aux_info/observed_bias_3p.gz"),
                    path("${params.outdir}/salmon/RAP1_IAA_30M_REP1/cmd_info.json"),
                    path("${params.outdir}/salmon/RAP1_IAA_30M_REP1/lib_format_counts.json"),
                    path("${params.outdir}/salmon/RAP1_UNINDUCED_REP1/aux_info/ambig_info.tsv"),
                    path("${params.outdir}/salmon/RAP1_UNINDUCED_REP1/aux_info/expected_bias.gz"),
                    path("${params.outdir}/salmon/RAP1_UNINDUCED_REP1/aux_info/observed_bias.gz"),
                    path("${params.outdir}/salmon/RAP1_UNINDUCED_REP1/aux_info/observed_bias_3p.gz"),
                    path("${params.outdir}/salmon/RAP1_UNINDUCED_REP1/cmd_info.json"),
                    path("${params.outdir}/salmon/RAP1_UNINDUCED_REP1/lib_format_counts.json"),
                    path("${params.outdir}/salmon/RAP1_UNINDUCED_REP2/aux_info/ambig_info.tsv"),
                    path("${params.outdir}/salmon/RAP1_UNINDUCED_REP2/aux_info/expected_bias.gz"),
                    path("${params.outdir}/salmon/RAP1_UNINDUCED_REP2/aux_info/observed_bias.gz"),
                    path("${params.outdir}/salmon/RAP1_UNINDUCED_REP2/aux_info/observed_bias_3p.gz"),
                    path("${params.outdir}/salmon/RAP1_UNINDUCED_REP2/cmd_info.json"),
                    path("${params.outdir}/salmon/RAP1_UNINDUCED_REP2/lib_format_counts.json"),
                    path("${params.outdir}/salmon/WT_REP1/aux_info/ambig_info.tsv"),
                    path("${params.outdir}/salmon/WT_REP1/aux_info/expected_bias.gz"),
                    path("${params.outdir}/salmon/WT_REP1/aux_info/observed_bias.gz"),
                    path("${params.outdir}/salmon/WT_REP1/aux_info/observed_bias_3p.gz"),
                    path("${params.outdir}/salmon/WT_REP1/cmd_info.json"),
                    path("${params.outdir}/salmon/WT_REP1/lib_format_counts.json"),
                    path("${params.outdir}/salmon/WT_REP2/aux_info/ambig_info.tsv"),
                    path("${params.outdir}/salmon/WT_REP2/aux_info/expected_bias.gz"),
                    path("${params.outdir}/salmon/WT_REP2/aux_info/observed_bias.gz"),
                    path("${params.outdir}/salmon/WT_REP2/aux_info/observed_bias_3p.gz"),
                    path("${params.outdir}/salmon/WT_REP2/cmd_info.json"),
                    path("${params.outdir}/salmon/WT_REP2/lib_format_counts.json"),
                    // These files are not stable
                    file("${params.outdir}/salmon/RAP1_IAA_30M_REP1/aux_info/fld.gz").name,
                    file("${params.outdir}/salmon/RAP1_IAA_30M_REP1/aux_info/meta_info.json").name,
                    file("${params.outdir}/salmon/RAP1_IAA_30M_REP1/libParams/flenDist.txt").name,
                    file("${params.outdir}/salmon/RAP1_IAA_30M_REP1/logs/salmon_quant.log").name,
                    file("${params.outdir}/salmon/RAP1_IAA_30M_REP1/quant.genes.sf").name,
                    file("${params.outdir}/salmon/RAP1_IAA_30M_REP1/quant.sf").name,
                    file("${params.outdir}/salmon/RAP1_UNINDUCED_REP1/aux_info/fld.gz").name,
                    file("${params.outdir}/salmon/RAP1_UNINDUCED_REP1/aux_info/meta_info.json").name,
                    file("${params.outdir}/salmon/RAP1_UNINDUCED_REP1/libParams/flenDist.txt").name,
                    file("${params.outdir}/salmon/RAP1_UNINDUCED_REP1/logs/salmon_quant.log").name,
                    file("${params.outdir}/salmon/RAP1_UNINDUCED_REP1/quant.genes.sf").name,
                    file("${params.outdir}/salmon/RAP1_UNINDUCED_REP1/quant.sf").name,
                    file("${params.outdir}/salmon/RAP1_UNINDUCED_REP2/aux_info/fld.gz").name,
                    file("${params.outdir}/salmon/RAP1_UNINDUCED_REP2/aux_info/meta_info.json").name,
                    file("${params.outdir}/salmon/RAP1_UNINDUCED_REP2/libParams/flenDist.txt").name,
                    file("${params.outdir}/salmon/RAP1_UNINDUCED_REP2/logs/salmon_quant.log").name,
                    file("${params.outdir}/salmon/RAP1_UNINDUCED_REP2/quant.genes.sf").name,
                    file("${params.outdir}/salmon/RAP1_UNINDUCED_REP2/quant.sf").name,
                    file("${params.outdir}/salmon/WT_REP1/aux_info/fld.gz").name,
                    file("${params.outdir}/salmon/WT_REP1/aux_info/meta_info.json").name,
                    file("${params.outdir}/salmon/WT_REP1/libParams/flenDist.txt").name,
                    file("${params.outdir}/salmon/WT_REP1/logs/salmon_quant.log").name,
                    file("${params.outdir}/salmon/WT_REP1/quant.genes.sf").name,
                    file("${params.outdir}/salmon/WT_REP1/quant.sf").name,
                    file("${params.outdir}/salmon/WT_REP2/aux_info/fld.gz").name,
                    file("${params.outdir}/salmon/WT_REP2/aux_info/meta_info.json").name,
                    file("${params.outdir}/salmon/WT_REP2/libParams/flenDist.txt").name,
                    file("${params.outdir}/salmon/WT_REP2/logs/salmon_quant.log").name,
                    file("${params.outdir}/salmon/WT_REP2/quant.genes.sf").name,
                    file("${params.outdir}/salmon/WT_REP2/quant.sf").name
                ).match("salmon_quant") },
                { assert snapshot(
                    path("${params.outdir}/salmon/tx2gene.tsv"),
                    // These files are not stable
                    file("${params.outdir}/salmon/salmon.merged.gene_counts.SummarizedExperiment.rds").name,
                    file("${params.outdir}/salmon/salmon.merged.gene_counts.tsv").name,
                    file("${params.outdir}/salmon/salmon.merged.gene_counts_length_scaled.SummarizedExperiment.rds").name,
                    file("${params.outdir}/salmon/salmon.merged.gene_counts_length_scaled.tsv").name,
                    file("${params.outdir}/salmon/salmon.merged.gene_counts_scaled.SummarizedExperiment.rds").name,
                    file("${params.outdir}/salmon/salmon.merged.gene_counts_scaled.tsv").name,
                    file("${params.outdir}/salmon/salmon.merged.gene_lengths.tsv").name,
                    file("${params.outdir}/salmon/salmon.merged.gene_tpm.tsv").name,
                    file("${params.outdir}/salmon/salmon.merged.transcript_counts.SummarizedExperiment.rds").name,
                    file("${params.outdir}/salmon/salmon.merged.transcript_counts.tsv").name,
                    file("${params.outdir}/salmon/salmon.merged.transcript_lengths.tsv").name,
                    file("${params.outdir}/salmon/salmon.merged.transcript_tpm.tsv").name
                ).match("salmon") },                { assert snapshot(
                    // These reports are not stable
                    file("${params.outdir}/trimgalore/RAP1_IAA_30M_REP1_trimmed_1.fastq.gz_trimming_report.txt").name,
                    file("${params.outdir}/trimgalore/RAP1_IAA_30M_REP1_trimmed_2.fastq.gz_trimming_report.txt").name,
                    file("${params.outdir}/trimgalore/RAP1_UNINDUCED_REP1_trimmed.fastq.gz_trimming_report.txt").name,
                    file("${params.outdir}/trimgalore/RAP1_UNINDUCED_REP2_trimmed.fastq.gz_trimming_report.txt").name,
                    file("${params.outdir}/trimgalore/WT_REP1_trimmed_1.fastq.gz_trimming_report.txt").name,
                    file("${params.outdir}/trimgalore/WT_REP1_trimmed_2.fastq.gz_trimming_report.txt").name,
                    file("${params.outdir}/trimgalore/WT_REP2_trimmed_1.fastq.gz_trimming_report.txt").name,
                    file("${params.outdir}/trimgalore/WT_REP2_trimmed_2.fastq.gz_trimming_report.txt").name
                ).match("trimgalore") },
                { assert snapshot(
                    UTILS.removeNextflowVersion("$outputDir/pipeline_info/nf_core_rnaseq_software_mqc_versions.yml")
                ).match("versions") }
            )
        }
    }

    test("Params: --aligner hisat2 - stub") {

        options "-stub"

        when {
            params {
                outdir = "$outputDir"
                aligner = 'hisat2'
            }
        }

        then {
            assertAll(
                { assert workflow.success },
                { assert snapshot(
                    UTILS.removeNextflowVersion("$outputDir/pipeline_info/nf_core_rnaseq_software_mqc_versions.yml"),
                    file("${params.outdir}/custom/out/genome_transcriptome.fasta").name,
                    file("${params.outdir}/custom/out/genome_transcriptome.gtf").name,
                    file("${params.outdir}/fastqc/raw/RAP1_IAA_30M_REP1_raw.html").name,
                    file("${params.outdir}/fastqc/raw/RAP1_IAA_30M_REP1_raw.zip").name,
                    file("${params.outdir}/fastqc/raw/RAP1_UNINDUCED_REP1_raw.html").name,
                    file("${params.outdir}/fastqc/raw/RAP1_UNINDUCED_REP1_raw.zip").name,
                    file("${params.outdir}/fastqc/raw/RAP1_UNINDUCED_REP2_raw.html").name,
                    file("${params.outdir}/fastqc/raw/RAP1_UNINDUCED_REP2_raw.zip").name,
                    file("${params.outdir}/fastqc/raw/WT_REP1_raw.html").name,
                    file("${params.outdir}/fastqc/raw/WT_REP1_raw.zip").name,
                    file("${params.outdir}/fastqc/raw/WT_REP2_raw.html").name,
                    file("${params.outdir}/fastqc/raw/WT_REP2_raw.zip").name,
                    file("${params.outdir}/multiqc/hisat2/multiqc_report.html").name,
                    file("${params.outdir}/trimgalore/RAP1_IAA_30M_REP1_trimmed_1.fastq.gz_trimming_report.txt").name,
                    file("${params.outdir}/trimgalore/RAP1_IAA_30M_REP1_trimmed_2.fastq.gz_trimming_report.txt").name,
                    file("${params.outdir}/trimgalore/RAP1_UNINDUCED_REP1_trimmed.fastq.gz_trimming_report.txt").name,
                    file("${params.outdir}/trimgalore/RAP1_UNINDUCED_REP2_trimmed.fastq.gz_trimming_report.txt").name,
                    file("${params.outdir}/trimgalore/WT_REP1_trimmed_1.fastq.gz_trimming_report.txt").name,
                    file("${params.outdir}/trimgalore/WT_REP1_trimmed_2.fastq.gz_trimming_report.txt").name,
                    file("${params.outdir}/trimgalore/WT_REP2_trimmed_1.fastq.gz_trimming_report.txt").name,
                    file("${params.outdir}/trimgalore/WT_REP2_trimmed_2.fastq.gz_trimming_report.txt").name
                ).match() }
            )
        }
    }
}
